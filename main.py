from module.rsa import main as rsa
from module.vigenere import main as vigenere
import binascii
import time
import os.path
import sys

def generateRsaKey():
    if not checkRsaKeyExist():
        try:
            rsa.generateKey()
            return True
        except Exception as e:
            print(f'Failed: {e}')
            sys.exit()
        
def checkRsaKeyExist():
    if os.path.isfile('key/priv.pem') and os.path.isfile('key/pub.pem'):
        return True
    
def encrypt(plaintext):
    start = time.perf_counter()
    generateRsaKey()
    initial_key = vigenere.generateUniqueKey()
    ciphertext = vigenere.encrypt(plaintext, initial_key)
    key_enc = rsa.encrypt(initial_key)
    stop = time.perf_counter()
    
    print(f"Encrypt used time: {stop - start:0.4f} seconds")
    return ciphertext, key_enc

def decrypt(ciphertext, key):
    start = time.perf_counter()
    generateRsaKey()
    key_dec = rsa.decrypt(key)
    plaintext = vigenere.decrypt(ciphertext, key_dec)
    stop = time.perf_counter()
    
    print(f"Decrypt used time: {stop - start:0.4f} seconds")
    return plaintext

# plaintext = "In cryptography, encryption is the process of encoding information."
plaintext = "In cryptography, encryption is the process of encoding information. This process converts the original representation of the information, known as plaintext, into an alternative form known as ciphertext. Ideally, only authorized parties can decipher a ciphertext back to plaintext and access the original information."
# plaintext = "In cryptography, encryption is the process of encoding information. This process converts the original representation of the information, known as plaintext, into an alternative form known as ciphertext. Ideally, only authorized parties can decipher a ciphertext back to plaintext and access the original information. Encryption does not itself prevent interference but denies the intelligible content to a would-be interceptor. For technical reasons, an encryption scheme usually uses a pseudo-random encryption key generated by an algorithm. It is possible to decrypt the message without possessing the key but, for a well-designed encryption scheme, considerable computational resources and skills are required. An authorized recipient can easily decrypt the message with the key provided by the originator to recipients but not to unauthorized users. Historically, various forms of encryption have been used to aid in cryptography. Early encryption techniques were often utilized in military messaging. Since then, new techniques have emerged and become commonplace in all areas of modern computing. Modern encryption schemes utilize the concepts of public-key and symmetric-key. Modern encryption techniques ensure security because modern computers are inefficient at cracking the encryption."

# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Nam consequat, mauris sagittis rhoncus facilisis, eros ex iaculis libero, et semper mauris lorem nec neque. Nulla nisi arcu, consequat et tempor in, commodo at nibh. Mauris a feugiat justo. Mauris a iaculis nibh. In eu consectetur nulla. Pellentesque sem nisl, porttitor a rutrum vitae, tristique sed dolor. Phasellus rhoncus tempor facilisis. Sed quis placerat orci. Nulla consectetur consequat lacus a tempus. Interdum et malesuada fames ac ante ipsum primis in faucibus. Vestibulum tristique purus id venenatis condimentum. Aliquam at nunc augue. Integer id vehicula dolor. Donec viverra, ipsum quis molestie cursus."
# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Ut ac pulvinar erat. Curabitur eu lobortis nisi, eu pellentesque ex. Aenean volutpat ac massa vitae vehicula. Nunc ut feugiat diam. Sed aliquam pulvinar leo, eget mattis dui euismod sed. Ut tempor odio sed turpis aliquet, eu malesuada nisl pulvinar. Nulla maximus nibh quis luctus mattis. Sed eget semper dui. Proin lobortis dolor quis urna mollis, vel blandit nisi egestas. Pellentesque viverra turpis lacus, ac rutrum mauris consequat quis. Duis vitae massa tempor, tristique tellus nec, vulputate leo. Nulla non iaculis diam, ac maximus est. Fusce non cursus libero, nec commodo mauris. Suspendisse potenti. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; In posuere ex odio, vel aliquet quam faucibus in. Proin a lorem vel lacus faucibus facilisis id quis nunc. Sed posuere molestie nisi quis pellentesque. Sed ac efficitur lorem. Curabitur in molestie justo, non lobortis ligula. Etiam viverra accumsan placerat. Donec rutrum, orci in congue varius, nisi lorem porta quam, ut eleifend sapien ex in erat. Vestibulum consectetur neque nec sagittis finibus. Nulla ut tellus sed nulla finibus congue. Maecenas a dui non ante egestas mollis. Duis vulputate enim ut mauris tincidunt ultricies. Pellentesque sit."
# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Quisque venenatis nulla eget magna maximus, eu accumsan est condimentum. Curabitur imperdiet sed ex nec eleifend. Maecenas non nunc odio. Vivamus pellentesque nisi nec mi rhoncus, vitae pellentesque mi pellentesque. Nullam eu mauris tempus, pharetra magna vitae, scelerisque mauris. Duis ut dolor urna. Donec tincidunt, risus a congue viverra, sem augue vestibulum magna, id interdum orci nunc eget elit. Duis arcu nulla, pellentesque at pulvinar non, cursus eu risus. Vestibulum ac egestas lectus. In et nulla non ante posuere condimentum ut ac orci. Donec vulputate, nibh a euismod congue, felis eros interdum sem, ac pellentesque velit nibh quis risus. Suspendisse eleifend tortor nec metus pellentesque, at feugiat quam sodales. Vivamus condimentum quis elit vitae interdum. Donec sit amet metus in ligula lacinia hendrerit et nec sapien. Praesent consequat mauris et posuere dictum. Quisque nec mattis massa. Donec est risus, pharetra id scelerisque a, facilisis in est. Maecenas vehicula condimentum neque et molestie. Maecenas sodales volutpat blandit. Donec vestibulum vestibulum quam, dapibus imperdiet tortor porta non. Fusce eros nisi, hendrerit vitae faucibus quis, pharetra sed augue. Donec turpis nisl, luctus vitae convallis eget, dictum ac elit. Duis a velit vel nunc vestibulum vehicula. Etiam finibus sed lorem et consequat. Phasellus dignissim dictum urna eget placerat. Suspendisse ac mollis felis. Nulla elementum consectetur nunc sed vestibulum. Vestibulum tincidunt nulla iaculis, luctus nibh et, posuere urna. Sed nec felis elementum, tincidunt velit et, congue turpis. Curabitur molestie scelerisque sapien vitae consectetur. Donec viverra nunc at eros gravida, at blandit urna molestie. Pellentesque habitant morbi tristique senectus et netus et malesuada fames ac turpis egestas. Fusce pulvinar eros et tincidunt maximus. Nulla semper enim posuere, vestibulum quam sed, feugiat urna. Sed volutpat nibh ut nulla bibendum, sit amet bibendum velit eleifend. Aenean vel cursus turpis. Aliquam."
# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Duis ullamcorper eu erat eget interdum. Mauris maximus pharetra odio at posuere. Sed at erat turpis. Vestibulum molestie quam est, ut ultrices ligula dignissim vel. Curabitur convallis orci eget eros varius vehicula. Cras hendrerit tempus rhoncus. In finibus leo at lectus convallis, at tristique lacus facilisis. Duis erat orci, condimentum in odio nec, finibus pulvinar ex. Etiam iaculis ultrices neque, vestibulum viverra nisi. Suspendisse vitae erat ut lorem laoreet placerat. Donec lobortis nec ipsum id varius. Ut congue rhoncus nunc vitae interdum. Aliquam blandit tellus ipsum, id fringilla augue mattis feugiat. Aenean mattis, elit vel faucibus hendrerit, magna nulla commodo sapien, eget sollicitudin enim quam sit amet mi. Donec turpis magna, euismod et tincidunt ac, rhoncus nec enim. Quisque sit amet fermentum libero. Integer at volutpat nulla. Aliquam id fermentum velit, sit amet scelerisque ex. Aenean eu tincidunt nisl, placerat lobortis sapien. Nullam lectus metus, faucibus ut suscipit vitae, malesuada nec dui. Nulla facilisi. Pellentesque ut tellus ante. Cras tristique luctus lacus, sed tincidunt nulla tincidunt sit amet. Donec pharetra ultricies egestas. Phasellus scelerisque fringilla nisl id mollis. Fusce in elit egestas, hendrerit risus id, dignissim enim. Mauris blandit ante vitae est lobortis semper. Maecenas ut turpis sit amet ex facilisis elementum. Vestibulum sagittis mauris sed ligula dignissim ullamcorper. Aenean commodo eu lorem ut aliquam. Morbi at urna id nulla blandit tincidunt eu in dolor. Nam mollis orci rutrum rhoncus elementum. Mauris ac tristique augue. Nunc euismod enim eget feugiat iaculis. Maecenas lacus leo, posuere ut pulvinar et, pellentesque in purus. Curabitur gravida vulputate cursus. Cras et risus neque. Aliquam convallis dui purus, et hendrerit magna convallis sit amet. Suspendisse aliquam risus quis enim semper varius. Vestibulum lectus odio, lobortis in lorem id, sollicitudin sodales dolor. Sed ac placerat quam. Suspendisse iaculis sollicitudin ligula, ut sodales ipsum fringilla in. Nam feugiat elementum sapien vitae euismod. Pellentesque viverra libero vel pretium vestibulum. Morbi non quam sit amet odio semper ultrices. Orci varius natoque penatibus et magnis dis parturient montes, nascetur ridiculus mus. Vestibulum nec dapibus justo. Aliquam egestas, est eget aliquet convallis, dolor dolor blandit odio, sed auctor arcu dolor sed eros. Aenean condimentum nunc in arcu porttitor, non pharetra eros rhoncus. Nulla ornare sapien id dui dictum, ut cursus mi tristique. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Ut vitae tellus at eros tempor faucibus. Nullam."
# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. Curabitur dui nulla, facilisis ut sollicitudin dapibus, congue eu est. Suspendisse sit amet ipsum hendrerit, gravida lectus id, elementum nisi. Curabitur scelerisque tempus aliquam. In pulvinar est in congue finibus. Ut vel posuere ligula, et mollis magna. Donec tempor congue metus sit amet auctor. Sed interdum suscipit venenatis. Proin elit massa, venenatis in justo non, rutrum molestie erat. Integer mi velit, facilisis sollicitudin pellentesque ut, sollicitudin ut lacus. Phasellus lacus mi, gravida iaculis quam et, blandit vestibulum lectus. Nulla bibendum felis elit, non molestie nunc vehicula non. In ullamcorper magna sit amet sapien sollicitudin, a feugiat turpis fermentum. Duis bibendum arcu nisl, id feugiat felis elementum in. Fusce viverra velit diam, quis commodo velit porta nec. In quis dignissim nisi. Mauris vitae mauris iaculis, consequat velit ut, ultrices sem. Quisque id est vel ipsum mollis dignissim. Vivamus porta urna sed elementum fermentum. Ut et lacus imperdiet, suscipit ligula eget, volutpat lectus. Nam a vehicula massa. In hac habitasse platea dictumst. Suspendisse molestie purus laoreet mollis bibendum. Ut nisi ligula, sodales ac mauris ut, porta posuere metus. Donec id posuere est, a gravida neque. Sed cursus turpis vitae massa congue finibus. Nunc ipsum diam, volutpat et volutpat eu, imperdiet non erat. Suspendisse ac sagittis lacus. Maecenas eu orci bibendum, fermentum eros non, bibendum quam. Cras eu finibus quam. Aenean a sapien nulla. Proin auctor dui consectetur sem vestibulum, eget volutpat dolor porta. Mauris enim quam, tincidunt non dolor et, egestas pharetra ipsum. Nulla non felis vitae purus imperdiet hendrerit in non nunc. In hac habitasse platea dictumst. Donec vulputate aliquet elit vel dignissim. Morbi sed semper sapien. Aenean volutpat scelerisque lectus, at commodo nisi auctor pellentesque. Curabitur convallis tellus eu tempor tincidunt. Aenean feugiat pharetra placerat. Praesent sit amet tristique lorem. Praesent luctus convallis hendrerit. Sed orci quam, condimentum nec diam a, fringilla suscipit sem. Cras pharetra lectus nulla, sed consectetur dolor convallis id. Maecenas at justo eros. Vestibulum porttitor nulla magna, vel sagittis lectus placerat at. Donec justo magna, tempus id tincidunt sed, tempus sit amet nulla. Donec euismod rutrum augue id pulvinar. Phasellus sed luctus sem. Sed augue eros, egestas in bibendum sit amet, tempor tempus lectus. Phasellus faucibus vulputate lacus, vitae scelerisque nunc facilisis id. Donec accumsan, nisi et sodales condimentum, tortor nibh scelerisque velit, id tempor ante velit nec nulla. Maecenas magna risus, lacinia a egestas vitae, pellentesque in risus. Ut vel egestas lorem. Cras sodales lectus id mattis tempus. Fusce in lacus sed arcu posuere malesuada. Ut a tellus purus. Aenean elementum lorem in sapien maximus, non venenatis nunc euismod. Duis iaculis a nunc non tempus. Donec facilisis, nulla ut luctus consectetur, lacus ante consequat turpis, a commodo nunc neque vel neque. Vivamus vehicula libero non arcu sagittis scelerisque. Ut sit amet tristique magna. In non velit cursus, suscipit mi at, sagittis magna. Mauris auctor felis vel fermentum convallis. Suspendisse dolor ipsum, ullamcorper eu mattis ac, egestas quis nunc. Nam malesuada iaculis massa, aliquam condimentum velit posuere nec."
# plaintext = "Lorem ipsum dolor sit amet, consectetur adipiscing elit. In ultricies nisl non felis pellentesque tincidunt. Nam at nisl et ipsum ultrices congue quis et sem. Fusce vulputate tortor sed ante varius interdum. Nunc eu lacinia sem. Curabitur non mi quis nibh facilisis gravida. Nunc in tincidunt leo. Phasellus ut quam lacus. Maecenas ultricies in nulla varius facilisis. Praesent aliquet sit amet quam vitae rhoncus. Cras non eros vitae ante porttitor aliquam at ut nisl. Sed efficitur lacinia nisl, in volutpat quam viverra in. Vivamus dictum ipsum elit, quis ornare nisi semper sed. Aenean tempus mollis mauris sed pretium. Etiam nec efficitur nulla. In et accumsan purus. Etiam lobortis varius enim, eget accumsan lorem laoreet vitae. Fusce vitae turpis sollicitudin tortor varius fringilla vitae quis odio. Praesent feugiat dolor vel ipsum convallis, vulputate ullamcorper justo pretium. Mauris sit amet sodales odio. Suspendisse pharetra vestibulum ipsum. Maecenas tincidunt, dolor non semper vehicula, turpis diam aliquet purus, non tempus velit velit vel enim. Aenean et enim vitae mi convallis egestas sed semper ipsum. Lorem ipsum dolor sit amet, consectetur adipiscing elit. Vivamus laoreet dolor justo. Suspendisse sagittis facilisis fermentum. In commodo nunc ut elit aliquet pulvinar. Aenean quam magna, condimentum et malesuada sit amet, dictum a mauris. Cras luctus nunc est, ac bibendum felis tristique vitae. Curabitur vitae ullamcorper dui. Cras dapibus lobortis eleifend. Vestibulum dapibus placerat posuere. Nulla quis sagittis augue. Suspendisse hendrerit venenatis ultrices. Integer maximus id lorem laoreet dapibus. Nam facilisis neque feugiat, rhoncus leo at, convallis leo. Nullam porta, nisl tincidunt accumsan commodo, ante risus sollicitudin mauris, id volutpat nibh dui sollicitudin nisl. Phasellus congue sem at ullamcorper sodales. Nullam a nulla ipsum. Proin ac tortor non augue condimentum sollicitudin et sit amet quam. Phasellus rhoncus dapibus augue, sed finibus nunc porta id. Aliquam rhoncus felis elit, at feugiat est vulputate sed. Proin leo leo, bibendum non placerat in, ultricies in metus. Integer at sem porttitor, sollicitudin lacus vitae, dignissim magna. Sed pharetra commodo velit, id sollicitudin elit ultrices ut. Integer faucibus nunc maximus, accumsan eros sit amet, aliquam metus. Mauris sollicitudin sem nisl, id fringilla enim bibendum et. Donec fringilla felis non lacus facilisis, at vehicula leo vehicula. Etiam tincidunt commodo ante. Aliquam erat volutpat. Fusce iaculis nunc non quam feugiat, sed consequat elit gravida. Cras sollicitudin nulla eu lobortis tincidunt. Morbi lacus tellus, tincidunt quis tempor a, fringilla eu eros. Mauris vitae mattis enim. Donec enim tortor, iaculis et consectetur cursus, elementum in odio. Maecenas at arcu scelerisque, porta est quis, cursus erat. Duis vitae venenatis dui. Etiam ut viverra arcu. Suspendisse venenatis diam sed mi auctor, et mattis lectus volutpat. Proin vestibulum auctor lorem sed accumsan. Praesent tincidunt faucibus iaculis. Proin placerat eros eget urna lacinia dignissim. Aenean varius, lorem quis imperdiet posuere, dui libero mattis tellus, non viverra mi sapien nec tortor. In hac habitasse platea dictumst. Curabitur ante tellus, laoreet id fermentum in, blandit vel orci. Aenean feugiat sollicitudin mi lacinia rutrum. Nullam mauris velit, porta in faucibus vitae, sagittis non magna. Ut nisl sapien, ullamcorper a dolor quis, vehicula semper velit. Ut purus leo, ornare id facilisis eget, elementum vitae sem. Ut lobortis lacus odio, quis ultricies libero ultricies non. Vivamus nec quam vitae nunc semper condimentum ut sed felis. Quisque porttitor sollicitudin ipsum, tincidunt dapibus dolor congue sit amet. Donec porta consequat tempor. Ut metus ipsum, facilisis ut volutpat non, iaculis pretium erat. Ut laoreet tortor et dapibus auctor. Mauris viverra elit in tempus ornare. Mauris non aliquet metus. Nulla tellus ante, sollicitudin ultricies massa id, accumsan ultrices quam. Donec malesuada risus non neque semper mollis. Aliquam molestie dolor id tortor malesuada, id porta ex dignissim. Maecenas sed urna ex. Quisque molestie faucibus justo, id dapibus nisl aliquam at. Quisque eget blandit nulla. Aliquam ipsum erat, condimentum nec purus ut, feugiat cursus sem. Morbi tempus ac nisl et bibendum. Proin a maximus nibh. Praesent sed laoreet dolor. Donec vel euismod enim. Praesent in magna ac urna molestie faucibus. Duis tincidunt est nibh, eu rhoncus massa porta sed. Praesent dignissim nunc ut suscipit fringilla. Nullam auctor odio mauris, non tristique massa auctor quis. Integer mattis nulla interdum justo mattis mattis. Aenean tempus nibh neque, eget auctor est maximus et. Donec lobortis, justo vitae interdum consequat, urna orci ornare tellus, quis fermentum urna eros ac felis. Mauris eleifend a nibh ut semper. Quisque quis iaculis lorem, eget tincidunt sapien. Morbi dolor ligula, porta vehicula mi eget, ultricies luctus felis. Vestibulum ante ipsum primis in faucibus orci luctus et ultrices posuere cubilia curae; Class aptent taciti sociosqu ad litora torquent per conubia nostra, per inceptos himenaeos. Cras sollicitudin faucibus turpis, et tempor odio ullamcorper nec. Suspendisse sodales magna at lacus rhoncus, vitae feugiat eros rutrum. Nam ullamcorper sed justo consectetur interdum. Maecenas iaculis mi at ornare dignissim. Etiam eu consectetur ligula, eget suscipit ex. Maecenas tortor risus, tincidunt vitae laoreet in, venenatis vitae nisi. Sed finibus egestas sodales. Suspendisse eu urna mollis, condimentum ipsum sit amet, tincidunt est. Integer nibh sem, tristique nec faucibus eu, elementum id ipsum. Etiam quis bibendum risus. Maecenas pulvinar, ipsum at blandit accumsan, augue neque semper arcu, ac suscipit urna nulla sit amet ante. Sed hendrerit pellentesque tortor, sit amet varius dolor euismod sit amet. Aenean suscipit consectetur ipsum ut vulputate. Phasellus pharetra maximus turpis, et accumsan diam. Etiam lacinia dolor quis lectus faucibus, ultricies porttitor nisi venenatis. Mauris rutrum, felis sagittis blandit porta, arcu metus fermentum neque, eu interdum magna tellus quis massa. Nunc dui leo, ullamcorper at est eu, accumsan venenatis turpis. Fusce tincidunt nisl vel odio faucibus imperdiet eu sit amet mi. Vivamus vel tincidunt orci, vitae sodales lectus. Praesent ac lorem lectus. Mauris eget dui sollicitudin, cursus libero ullamcorper, eleifend felis. Pellentesque at aliquet sapien. Proin blandit lectus massa, eu tempus mi pellentesque at. Donec nec dignissim diam, vitae venenatis elit. Nulla quis nisi dignissim, accumsan lorem nec, imperdiet ligula. Suspendisse rhoncus magna sit amet diam mollis, et rutrum metus bibendum. Morbi ullamcorper est elit, vel mattis tellus tincidunt vitae. Donec eget volutpat orci, eget dictum."

ciphertext, key = encrypt(plaintext)
decrypt = decrypt(ciphertext, key)

print(f"""
dec = {decrypt}
      """)
